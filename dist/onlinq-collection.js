(()=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(e,n){return!n||"object"!==t(n)&&"function"!=typeof n?r(e):n}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){var e="function"==typeof Map?new Map:void 0;return(l=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return a(t,arguments,u(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),s(o,t)})(t)}function a(t,e,n){return(a=c()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&s(i,n.prototype),i}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){var n=e.get(t);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(t):n.value}function h(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function d(t,e,n){var o=e.get(t);if(!o)throw new TypeError("attempted to set private field on non-instance");if(o.set)o.set.call(t,n);else{if(!o.writable)throw new TypeError("attempted to set read only private field");o.value=n}return n}var y=new WeakMap,p=new WeakMap,v=new WeakMap,m=new WeakMap,b=new WeakMap,w=new WeakSet,g=new WeakSet,A=new WeakSet,k=new WeakSet,S=new WeakSet,x=new WeakSet,E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(E,t);var e,n,l,a,f=(e=E,n=c(),function(){var t,o=u(e);if(n){var r=u(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return i(this,t)});function E(){var t,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,E),t=f.call(this),x.add(r(t)),S.add(r(t)),k.add(r(t)),A.add(r(t)),g.add(r(t)),w.add(r(t)),!1,(n="nextIndex")in(e=r(t))?Object.defineProperty(e,n,{value:false,enumerable:!0,configurable:!0,writable:!0}):e[n]=false,y.set(r(t),{writable:!0,value:null}),p.set(r(t),{writable:!0,value:null}),v.set(r(t),{writable:!0,value:null}),m.set(r(t),{writable:!0,value:null}),b.set(r(t),{writable:!0,value:null}),t.attachShadow({mode:"open"}),d(r(t),b,W.bind(r(t))),t}return l=E,(a=[{key:"connectedCallback",value:function(){h(this,x,_).call(this),h(this,k,M).call(this),this.nextIndex=this.entries.length,this.max>0&&this.entries.length>=this.max&&this.disableAddButtons()}},{key:"disconnectedCallback",value:function(){h(this,S,q).call(this)}},{key:"entry",value:function(t){return this.entries.find((function(e){return e.index===t.toString()}))}},{key:"addEntry",value:function(){if(this.allowAdd&&this.prototype&&!(this.max>0&&this.entries.length>=this.max)){var t=this.nextIndex++,e=this.prototype.cloneNode(!0),n=document.createElement("onlinq-collection-entry");n.appendChild(e),n.collection=this,n.index=t,this.appendChild(n),this.dispatchEvent(new CustomEvent("entryAdded",{entry:n})),this.max>0&&this.entries.length>=this.max&&this.disableAddButtons(),this.min>0&&this.entries.length>this.min&&this.entries.forEach((function(t){t.enableDeleteButtons()})),h(this,g,O).call(this)}}},{key:"deleteEntry",value:function(t){if(this.allowDelete&&!(this.min>0&&this.entries.length<=this.min)){var e=this.entry(t);this.dispatchEvent(new CustomEvent("beforeEntryRemoved",{entry:e})),e.remove(),this.entries.forEach((function(e){e.index<t||(e.index=e.index-1)})),this.nextIndex--,this.dispatchEvent(new CustomEvent("entryRemoved")),this.max>0&&this.entries.length<this.max&&this.enableAddButtons(),this.min>0&&this.entries.length<=this.min&&this.entries.forEach((function(t){t.disableDeleteButtons()})),0===this.entries.length&&h(this,A,R).call(this)}}},{key:"moveEntry",value:function(t,e){var n=this.entry(t),o=this.entry(e);n&&o&&(o.index="__swap__",n.index=e,o.index=t,e>t?this.insertBefore(o,n):this.insertBefore(n,o))}},{key:"enableAddButtons",value:function(){h(this,w,j).call(this).forEach((function(t){t.removeAttribute("disabled"),t.classList.remove("disabled")}))}},{key:"disableAddButtons",value:function(){h(this,w,j).call(this).forEach((function(t){t.setAttribute("disabled","disabled"),t.classList.add("disabled")}))}},{key:"name",get:function(){var t;return null!==(t=this.getAttribute("name"))&&void 0!==t?t:null},set:function(t){this.setAttribute("name",t)}},{key:"entries",get:function(){return Array.from(this.querySelectorAll(":scope > onlinq-collection-entry"))}},{key:"min",get:function(){var t;return+(null!==(t=this.getAttribute("min"))&&void 0!==t?t:0)},set:function(t){t?this.setAttribute("min",t.toString()):this.removeAttribute("min")}},{key:"max",get:function(){var t;return+(null!==(t=this.getAttribute("max"))&&void 0!==t?t:0)},set:function(t){t?this.setAttribute("max",t.toString()):this.removeAttribute("max")}},{key:"allowAdd",get:function(){return this.hasAttribute("allow-add")},set:function(t){t?this.setAttribute("allow-add","allow-add"):this.removeAttribute("allow-add")}},{key:"allowDelete",get:function(){return this.hasAttribute("allow-delete")},set:function(t){t?this.setAttribute("allow-delete","allow-delete"):this.removeAttribute("allow-delete")}},{key:"allowMove",get:function(){return this.hasAttribute("allow-move")},set:function(t){t?this.setAttribute("allow-move","allow-move"):this.removeAttribute("allow-move")}},{key:"prefix",get:function(){var t,e;return null!==(t=null!==(e=this.getAttribute("prefix"))&&void 0!==e?e:this.name)&&void 0!==t?t:null},set:function(t){t?this.setAttribute("prefix",t):this.removeAttribute("prefix")}},{key:"prototype",get:function(){var t,e,n=null;return this.name&&(n=this.querySelector('template[collection="'.concat(this.name,'"][collection-prototype]'))),n||(n=this.querySelector("template[collection-prototype]")),null!==(t=null===(e=n)||void 0===e?void 0:e.content)&&void 0!==t&&t}},{key:"prototypeName",get:function(){return this.hasAttribute("prototype-name")?this.getAttribute("prototype-name"):"__name__"},set:function(t){this.setAttribute("prototype-name",t)}}])&&o(l.prototype,a),E}(l(HTMLElement)),j=function(){var t=this;return[].concat(e(Array.from(this.shadowRoot.querySelectorAll("[collection-add]"))),e(Array.from(this.querySelectorAll("[collection-add]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.name}))},O=function(){f(this,y).style.display="block",f(this,p).style.display="none"},R=function(){f(this,y).style.display="none",f(this,p).style.display="block"},M=function(){var t=this;this.allowAdd&&h(this,w,j).call(this).forEach((function(e){e.addEventListener("click",f(t,b))}))},q=function(){var t=this;this.allowAdd&&h(this,w,j).call(this).forEach((function(e){e.removeEventListener("click",f(t,b))}))},_=function(){this.shadowRoot.innerHTML='<style type="text/css">\n  :host {\n    --collection-display: block;\n    --collection-justify-content: flex-start;\n    --collection-align-items: flex-start;\n    --collection-contents-margin: 0 0 1rem;\n    --collection-contents-flex-grow: 1;\n    --collection-actions-margin: 0 0 1rem;\n    --collection-actions-flex-grow: 0;\n\n    display: var(--collection-display);\n    justify-content: var(--collection-justify-content);\n    align-items: var(--collection-align-items);\n  }\n\n  .contents {\n    flex-grow: var(--collection-contents-flex-grow);\n    margin: var(--collection-contents-margin);\n  }\n\n  .actions {\n    flex-grow: var(--collection-actions-flex-grow);\n    margin: var(--collection-actions-margin);\n  }\n\n  [data-collection],\n  [data-add] {\n    display: none;\n  }\n</style>\n\n<div class="contents" data-collection>\n  <slot></slot>\n</div>\n<div class="contents" data-placeholder>\n  <slot name="placeholder">\n    <span>No entries</span>\n  </slot>\n</div>\n<div class="actions" data-actions>\n  <slot name="actions">\n    <span data-add>\n      <slot name="add">\n        <button collection-add>Add</button>\n      </slot>\n    </span>\n  </slot>\n</div>\n',d(this,y,this.shadowRoot.querySelector("[data-collection]")),d(this,p,this.shadowRoot.querySelector("[data-placeholder]")),d(this,v,this.shadowRoot.querySelector("[data-actions]")),d(this,m,this.shadowRoot.querySelector("[data-add]")),this.entries.length>0&&h(this,g,O).call(this),this.allowAdd&&(f(this,m).style.display="inline")};function W(){this.addEntry()}function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function P(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function C(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?B(t):e}function B(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t){var e="function"==typeof Map?new Map:void 0;return(I=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return N(t,arguments,U(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),F(o,t)})(t)}function N(t,e,n){return(N=H()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&F(i,n.prototype),i}).apply(null,arguments)}function H(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t,e){var n=e.get(t);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(t):n.value}function z(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function G(t,e,n){var o=e.get(t);if(!o)throw new TypeError("attempted to set private field on non-instance");if(o.set)o.set.call(t,n);else{if(!o.writable)throw new TypeError("attempted to set read only private field");o.value=n}return n}customElements.define("onlinq-collection",E);var J=new WeakMap,K=new WeakMap,Q=new WeakMap,V=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakSet,nt=new WeakSet,ot=new WeakSet,it=new WeakSet,rt=new WeakSet,lt=new WeakSet,at=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(l,t);var e,n,o,i,r=(e=l,n=H(),function(){var t,o=U(e);if(n){var i=U(this).constructor;t=Reflect.construct(o,arguments,i)}else t=o.apply(this,arguments);return C(this,t)});function l(){var t,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this),lt.add(B(t)),rt.add(B(t)),it.add(B(t)),ot.add(B(t)),nt.add(B(t)),et.add(B(t)),null,(n="collection")in(e=B(t))?Object.defineProperty(e,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[n]=null,J.set(B(t),{writable:!0,value:null}),K.set(B(t),{writable:!0,value:null}),Q.set(B(t),{writable:!0,value:null}),V.set(B(t),{writable:!0,value:null}),X.set(B(t),{writable:!0,value:null}),Y.set(B(t),{writable:!0,value:null}),Z.set(B(t),{writable:!0,value:null}),tt.set(B(t),{writable:!0,value:null}),t.attachShadow({mode:"open"}),G(B(t),Y,yt.bind(B(t))),G(B(t),Z,pt.bind(B(t))),G(B(t),tt,vt.bind(B(t))),t}return o=l,(i=[{key:"connectedCallback",value:function(){this.collection||(this.collection=this.collectionName?this.closest('onlinq-collection[name="'.concat(this.collectionName,'"]')):this.closest("onlinq-collection")),z(this,lt,dt).call(this),z(this,it,ft).call(this),this.collection&&this.collection.min>0&&this.collection.entries.length<=this.collection.min&&this.disableDeleteButtons()}},{key:"disconnectedCallback",value:function(){z(this,rt,ht).call(this)}},{key:"deleteEntry",value:function(){this.collection.deleteEntry(this.index)}},{key:"moveDown",value:function(){this.collection.moveEntry(+this.index,+this.index+1)}},{key:"moveUp",value:function(){this.collection.moveEntry(+this.index,+this.index-1)}},{key:"enableDeleteButtons",value:function(){z(this,et,ct).call(this).forEach((function(t){t.removeAttribute("disabled"),t.classList.remove("disabled")}))}},{key:"disableDeleteButtons",value:function(){z(this,et,ct).call(this).forEach((function(t){t.setAttribute("disabled","disabled"),t.classList.add("disabled")}))}},{key:"collectionName",get:function(){var t;return null!==(t=this.getAttribute("collection"))&&void 0!==t?t:null}},{key:"index",get:function(){var t;return null!==(t=this.getAttribute("collection-index"))&&void 0!==t&&t},set:function(t){var e=this.index||this.collection.prototypeName;this.setAttribute("collection-index",t.toString());var n=this.querySelector("[collection-label]");n&&(n.innerHTML=t);var o=this.collection.getAttribute("id"),i=this.collection.prefix;o&&mt(this.querySelectorAll("*"),"".concat(o,"_").concat(e),"".concat(o,"_").concat(t)),i&&mt(this.querySelectorAll("*"),"".concat(i,"[").concat(e,"]"),"".concat(i,"[").concat(t,"]"))}}])&&P(o.prototype,i),l}(I(HTMLElement)),ct=function(){var t=this;return[].concat(L(Array.from(this.shadowRoot.querySelectorAll("[collection-delete]"))),L(Array.from(this.querySelectorAll("[collection-delete]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.collectionName}))},st=function(){var t=this;return[].concat(L(Array.from(this.shadowRoot.querySelectorAll("[collection-move-down]"))),L(Array.from(this.querySelectorAll("[collection-move-down]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.collectionName}))},ut=function(){var t=this;return[].concat(L(Array.from(this.shadowRoot.querySelectorAll("[collection-move-up]"))),L(Array.from(this.querySelectorAll("[collection-move-up]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.collectionName}))},ft=function(){var t=this;z(this,nt,st).call(this).forEach((function(e){e.addEventListener("click",$(t,Z))})),z(this,ot,ut).call(this).forEach((function(e){e.addEventListener("click",$(t,tt))})),z(this,et,ct).call(this).forEach((function(e){e.addEventListener("click",$(t,Y))}))},ht=function(){var t=this;z(this,nt,st).call(this).forEach((function(e){e.removeEventListener("click",$(t,Z))})),z(this,ot,ut).call(this).forEach((function(e){e.removeEventListener("click",$(t,tt))})),z(this,et,ct).call(this).forEach((function(e){e.removeEventListener("click",$(t,Y))}))},dt=function(){this.shadowRoot.innerHTML='<style type="text/css">\n  :host {\n    --collection-entry-display: block;\n    --collection-entry-justify-content: flex-start;\n    --collection-entry-align-items: flex-start;\n    --collection-entry-contents-margin: 0 0 1rem;\n    --collection-entry-contents-flex-grow: 1;\n    --collection-entry-actions-margin: 0 0 1rem;\n    --collection-entry-actions-flex-grow: 0;\n\n    display: var(--collection-entry-display);\n    justify-content: var(--collection-entry-justify-content);\n    align-items: var(--collection-entry-align-items);\n  }\n\n  .contents {\n    flex-grow: var(--collection-entry-contents-flex-grow);\n    margin: var(--collection-entry-contents-margin);\n  }\n\n  .actions {\n    flex-grow: var(--collection-entry-actions-flex-grow);\n    margin: var(--collection-entry-actions-margin);\n  }\n\n  [data-move-up],\n  [data-move-down],\n  [data-delete] {\n    display: none;\n  }\n</style>\n\n<div class="contents" data-entry>\n  <slot></slot>\n</div>\n<div class="actions" data-actions>\n  <slot name="actions">\n    <span data-move-up>\n      <slot name="move-up">\n        <button collection-move-up>Move up</button>\n      </slot>\n    </span>\n    <span data-move-down>\n      <slot name="move-down">\n        <button collection-move-down>Move down</button>\n      </slot>\n    </span>\n    <span data-delete>\n      <slot name="delete">\n        <button collection-delete>Delete</button>\n      </slot>\n    </span>\n  </slot>\n</div>\n',G(this,J,this.shadowRoot.querySelector("[data-entry]")),G(this,K,this.shadowRoot.querySelector("[data-actions]")),G(this,Q,this.shadowRoot.querySelector("[data-delete]")),G(this,V,this.shadowRoot.querySelector("[data-move-down]")),G(this,X,this.shadowRoot.querySelector("[data-move-up]")),this.collection&&(this.collection.allowMove&&($(this,X).style.display="inline",$(this,V).style.display="inline"),this.collection.allowDelete&&($(this,Q).style.display="inline"))};function yt(){this.collection.allowDelete&&this.deleteEntry()}function pt(){this.collection.allowMove&&this.moveDown()}function vt(){this.collection.allowMove&&this.moveUp()}function mt(t,e,n){t.forEach((function(t){L(t.attributes).map((function(t){t.value.includes(e)&&(t.value=t.value.replace(e,n))}))}))}customElements.define("onlinq-collection-entry",at)})();